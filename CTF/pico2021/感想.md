# pico 2021

## Cryptography

### Mind your Ps and Qs
- 概要
  - RSA 
  - c, n, eが与えられる
  - nがかなり小さい。270bit
- 解法
  - 素因数分解ができる
  - sympy.ntheory.factorintはだめだった。
  - http://factordb.com/index.php　ここになげたらすぐ帰ってきた
  - p, qがわかれば終わり

### Easy Peasy
- 概要
  - One Time Pad
  - keyが50000の配列でunknown
  - 文字列を与えると文字コード xor key[idx]して返してくれる
  - idxは50000を超えるとループする
  - 最初にidx=0の状態からflagをencryptしてくれる
- 解法
  - encrypt結果から文字数がわかり、keyの今のidxがわかる
  - 50000文字の"0"とかを送るとkeyが逆算できるのでflag_encを復元できる

### New Caesar

- 概要
  - 変な変換 + シーザー暗号
  - flagに変な変換をしてから、何かしらのalphabetのkey (len==1)でずらす
- 解法
  - どちらも簡単に逆変換ができる
  - keyを26通り試して全部alphabetになるやつを試して終わり

### mini RSA

- 概要
  - RSA
  - n, e, cが与えられる
  - e=3で小さい
  - 問題文で we padded the plaintext so that (M ** e) is just barely larger than N とある
- 解法
  - m^eがNよりちょい大きいと言ってるので、x = i * n + c　の3乗根を適当に計算したらi=3533でできた

### Dachshund Attacks

- 概要
  - RSA
  - n, e, cが与えれる
  - eがめっちゃでかい
- 解法
  - eがでかいのでdが小さい可能性が高い
  - https://hackmd.io/@orisano/ryhoUinFe?type=view
  - wiener's attackでいける
  
### No Padding, No Problem

- 概要
  - RSA 
  - n, e, cが与えられる
  - c以外を複合してくれる
- 解法
  - lsb decryption attackかと思ったが、500回までで接続が切れてしまう
  - よく考えると、2^e * cの復号結果c'は 2m mod n になり、
  - 2mが偶数だったら c'/2, 奇数だったら (c' + n)/2が答えになる
  - 復号1回で終わり

### Play Nice

- 概要
  - オリジナル暗号化
  - 暗号化方法がコードで与えられる
- 解法
  - 理解すれば復号が簡単にできるのでそれだけ

### Double DES
- 概要
  - DES ECB
  - 暗号化方法がコードで与えられる
  - KEY1, KEY2をそれぞれ1e6通りの中からランダムに生成。
  - msg -> KEY1でDES encrypt -> KEY2でDES encrypt
  - flagを上記方法で暗号化したやつと、任意のmsgを暗号化したやつをもらえる
- 解法
  - DESは8byteごとに完全に独立で暗号化される
  - また、keyが与えられれば暗号化と復号ができる
  - msg = \x00 * 8を暗号化してもらって, enc2をもらう 
  - keyの空間が1e6通りしかないのを利用する
  - msgを1e6通りのKEY1で暗号化したものを覚えておく set_enc1
  - 次に、enc2を1e6通りのKEY2で復号したものが、上記のset_enc1にあるかどうかを見ていと nlognで求まる
  - 中間一致攻撃という。これがあるので2DESは意味がなく3DESが使われる

### Pixelated

- 概要
  - 画像が2つ与えられる
  - hint
    - https://en.wikipedia.org/wiki/Visual_cryptography
- 解法
  - 色々画像2つから画像を作る方法試していたら、普通に足し算すると答えが浮かび上がった


### New Vignere
- 概要
  - new caeserのkeyが最大14文字版
- 解法
  - 元の文字列が0~9,a~fしかないので、
  - ascii byteとして取りうる値が限られる
  - keyの文字列を固定すると、len(key)ごとに同じ文字でshiftされる。
  - その全ての結果がasciiとして正しくならないといけない、という制約を考えていくと
  - keyの文字数が9しか合わなくなり、制約内で全探索すると出てきた。




## Web Exploitation

### Scavenger Hunt

- 概要
    - web知識系
- 解法
    - js 
      - /* How can I keep Google from indexing my website? */
    - -> robots.txt
      - I think this is an apache server... can you Access the next flag?
    - -> .htaccess, 
      - I love making websites on my Mac, I can Store a lot of information there.
    - -> .DS_Storeを順に調べていくとflagがある

### Some Assembly Required 1
- 概要
  - 難読js
  - web assembly
- 解法
  - object['attr'] == object.attrと同じ
  - 読みやすくするとweb assemblyのバイナリをダウンロードしている
  - これを手元に落としてcatしたらflagがあった

### Some Assembly Required 1
- 概要
  - 難読js
  - web assembly
- 解法
  - 1とだいたい同じだが、ちゃんとweb assemblyを読まないといけない
  - 